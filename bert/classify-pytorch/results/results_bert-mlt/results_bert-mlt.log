2020-08-20 02:01:11,039 - main - INFO - {
  "train": "datasets/mlit/04-train.txt",
  "valid": "datasets/mlit/04-test.txt",
  "pretrained": "cl-tohoku/bert-base-japanese-whole-word-masking",
  "batchsize": 64,
  "learnrate": 2e-05,
  "epoch": 10,
  "out": "results_bert-4-mlt",
  "noplot": false
}
# train: 46742, valid: 5197
# class: 16, labels: {'エンジン': 0, '制動装置': 1, '動力伝達': 2, '排ｶﾞｽ･騒音': 3, '乗車装置': 4, '保安灯火': 5, '車枠・車体': 6, 'かじ取り': 7, '電気装置': 8, '燃料装置': 9, 'その他': 10, '電動機(モーター)': 11, '緩衝装置': 12, '走行装置': 13, '装置その他': 14, '非装置': 15}
# vocab: 32000
Linear(in_features=768, out_features=16, bias=True)
2020-08-20 02:08:08,041 - main - INFO - [  1] T/loss=0.772249 T/acc1=0.785247 T/acc2=0.000000 T/sec= 360.639226 D/loss=0.481126 D/acc1=0.862998 D/acc2=0.715137 D/sec= 12.366193 
saving early-stopped model (loss) at epoch 1
saving early-stopped model (uar) at epoch 1
2020-08-20 02:16:52,732 - main - INFO - [  2] T/loss=0.428546 T/acc1=0.876214 T/acc2=0.000000 T/sec= 512.311893 D/loss=0.448293 D/acc1=0.874735 D/acc2=0.727704 D/sec= 12.378893 
saving early-stopped model (loss) at epoch 2
saving early-stopped model (uar) at epoch 2
2020-08-20 02:24:11,761 - main - INFO - [  3] T/loss=0.341935 T/acc1=0.899726 T/acc2=0.000000 T/sec= 426.646790 D/loss=0.458531 D/acc1=0.877044 D/acc2=0.723688 D/sec= 12.383017 
2020-08-20 02:30:32,634 - main - INFO - [  4] T/loss=0.273988 T/acc1=0.920671 T/acc2=0.000000 T/sec= 368.496383 D/loss=0.465648 D/acc1=0.873196 D/acc2=0.731104 D/sec= 12.375902 
saving early-stopped model (uar) at epoch 4
2020-08-20 02:37:24,951 - main - INFO - [  5] T/loss=0.216407 T/acc1=0.937444 T/acc2=0.000000 T/sec= 399.935173 D/loss=0.499690 D/acc1=0.870502 D/acc2=0.735899 D/sec= 12.381942 
saving early-stopped model (uar) at epoch 5
2020-08-20 02:44:10,239 - main - INFO - [  6] T/loss=0.172171 T/acc1=0.950195 T/acc2=0.000000 T/sec= 392.872127 D/loss=0.552768 D/acc1=0.873388 D/acc2=0.738475 D/sec= 12.415823 
saving early-stopped model (uar) at epoch 6
2020-08-20 02:51:00,199 - main - INFO - [  7] T/loss=0.137191 T/acc1=0.959244 T/acc2=0.000000 T/sec= 397.593386 D/loss=0.576665 D/acc1=0.870310 D/acc2=0.741803 D/sec= 12.366463 
saving early-stopped model (uar) at epoch 7
2020-08-20 02:57:49,334 - main - INFO - [  8] T/loss=0.109154 T/acc1=0.967738 T/acc2=0.000000 T/sec= 396.757207 D/loss=0.642130 D/acc1=0.865307 D/acc2=0.729151 D/sec= 12.378263 
2020-08-20 03:04:07,780 - main - INFO - [  9] T/loss=0.087953 T/acc1=0.974349 T/acc2=0.000000 T/sec= 366.060546 D/loss=0.702418 D/acc1=0.873966 D/acc2=0.747990 D/sec= 12.385212 
saving early-stopped model (uar) at epoch 9
2020-08-20 03:10:54,654 - main - INFO - [ 10] T/loss=0.073781 T/acc1=0.978863 T/acc2=0.000000 T/sec= 394.504868 D/loss=0.747309 D/acc1=0.868193 D/acc2=0.740413 D/sec= 12.368943 

==== Confusion matrix 1 (early_stopped-loss) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	1374	7	24	5	1	0	12	8	21	29	12	1	0	0	0	0
制動装置	13	439	3	0	0	4	5	3	0	1	4	1	1	3	0	0
動力伝達	61	3	726	0	1	1	8	2	4	1	2	3	1	1	0	0
排ｶﾞｽ･騒音	12	0	2	103	0	0	1	0	1	2	0	0	0	1	0	0
乗車装置	2	0	0	0	273	0	8	1	2	0	3	0	1	0	0	0
保安灯火	1	0	2	0	1	349	4	0	5	0	1	0	0	0	0	0
車枠・車体	20	2	3	3	11	12	242	3	4	5	7	0	10	1	0	0
かじ取り	11	3	0	0	0	4	5	263	2	0	1	0	5	5	0	0
電気装置	15	3	1	0	6	10	5	4	126	1	6	0	0	0	0	0
燃料装置	15	1	0	0	0	0	2	0	1	213	0	0	0	0	0	0
その他	28	6	3	1	7	8	33	0	7	3	202	0	1	1	0	0
電動機(モーター)	8	0	3	0	0	0	0	1	2	0	2	18	0	0	0	0
緩衝装置	1	0	1	0	0	0	10	1	0	0	0	0	113	3	0	0
走行装置	2	1	3	0	0	0	9	4	0	0	1	0	2	105	0	0
装置その他	0	0	1	1	0	0	2	0	2	0	5	0	1	0	0	0
非装置	3	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0

==== Confusion matrix 2 (early_stopped-loss) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	0.92	0.00	0.02	0.00	0.00	0.00	0.01	0.01	0.01	0.02	0.01	0.00	0.00	0.00	0.00	0.00
制動装置	0.03	0.92	0.01	0.00	0.00	0.01	0.01	0.01	0.00	0.00	0.01	0.00	0.00	0.01	0.00	0.00
動力伝達	0.07	0.00	0.89	0.00	0.00	0.00	0.01	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
排ｶﾞｽ･騒音	0.10	0.00	0.02	0.84	0.00	0.00	0.01	0.00	0.01	0.02	0.00	0.00	0.00	0.01	0.00	0.00
乗車装置	0.01	0.00	0.00	0.00	0.94	0.00	0.03	0.00	0.01	0.00	0.01	0.00	0.00	0.00	0.00	0.00
保安灯火	0.00	0.00	0.01	0.00	0.00	0.96	0.01	0.00	0.01	0.00	0.00	0.00	0.00	0.00	0.00	0.00
車枠・車体	0.06	0.01	0.01	0.01	0.03	0.04	0.75	0.01	0.01	0.02	0.02	0.00	0.03	0.00	0.00	0.00
かじ取り	0.04	0.01	0.00	0.00	0.00	0.01	0.02	0.88	0.01	0.00	0.00	0.00	0.02	0.02	0.00	0.00
電気装置	0.08	0.02	0.01	0.00	0.03	0.06	0.03	0.02	0.71	0.01	0.03	0.00	0.00	0.00	0.00	0.00
燃料装置	0.06	0.00	0.00	0.00	0.00	0.00	0.01	0.00	0.00	0.92	0.00	0.00	0.00	0.00	0.00	0.00
その他	0.09	0.02	0.01	0.00	0.02	0.03	0.11	0.00	0.02	0.01	0.67	0.00	0.00	0.00	0.00	0.00
電動機(モーター)	0.24	0.00	0.09	0.00	0.00	0.00	0.00	0.03	0.06	0.00	0.06	0.53	0.00	0.00	0.00	0.00
緩衝装置	0.01	0.00	0.01	0.00	0.00	0.00	0.08	0.01	0.00	0.00	0.00	0.00	0.88	0.02	0.00	0.00
走行装置	0.02	0.01	0.02	0.00	0.00	0.00	0.07	0.03	0.00	0.00	0.01	0.00	0.02	0.83	0.00	0.00
装置その他	0.00	0.00	0.08	0.08	0.00	0.00	0.17	0.00	0.17	0.00	0.42	0.00	0.08	0.00	0.00	0.00
非装置	0.75	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.25	0.00	0.00	0.00	0.00	0.00	0.00

UAR = 0.727704

==== Classification report (early_stopped-loss) ====

              precision    recall  f1-score   support

        かじ取り       0.91      0.88      0.89       299
         その他       0.82      0.67      0.74       300
        エンジン       0.88      0.92      0.90      1494
        乗車装置       0.91      0.94      0.93       290
        保安灯火       0.90      0.96      0.93       363
        制動装置       0.94      0.92      0.93       477
        動力伝達       0.94      0.89      0.92       814
     排ｶﾞｽ･騒音       0.91      0.84      0.88       122
        燃料装置       0.83      0.92      0.87       232
        緩衝装置       0.84      0.88      0.86       129
       装置その他       0.00      0.00      0.00        12
        走行装置       0.88      0.83      0.85       127
       車枠・車体       0.70      0.75      0.72       323
   電動機(モーター)       0.78      0.53      0.63        34
        電気装置       0.71      0.71      0.71       177
         非装置       0.00      0.00      0.00         4

    accuracy                           0.87      5197
   macro avg       0.75      0.73      0.73      5197
weighted avg       0.87      0.87      0.87      5197

/usr/local/lib/python3.6/dist-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))

==== Confusion matrix 1 (early_stopped-uar) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	1363	6	35	4	1	1	16	10	16	24	16	2	0	0	0	0
制動装置	9	444	3	0	0	4	4	4	0	0	4	0	1	4	0	0
動力伝達	51	3	741	0	2	2	3	1	1	1	5	0	1	2	1	0
排ｶﾞｽ･騒音	12	0	1	104	0	0	1	0	0	3	0	0	0	1	0	0
乗車装置	2	0	0	0	275	1	7	0	1	0	3	0	1	0	0	0
保安灯火	3	1	1	0	1	345	3	0	6	0	2	0	0	0	1	0
車枠・車体	26	2	10	1	12	12	236	4	3	2	7	0	6	1	1	0
かじ取り	13	3	4	1	0	3	4	260	2	0	0	0	7	2	0	0
電気装置	15	4	0	0	7	11	7	4	122	1	5	1	0	0	0	0
燃料装置	25	1	0	0	0	0	1	0	0	203	1	0	0	1	0	0
その他	25	8	5	1	9	6	25	1	0	3	213	1	1	1	1	0
電動機(モーター)	7	1	4	0	0	0	0	1	1	0	3	17	0	0	0	0
緩衝装置	1	1	5	0	0	0	8	4	0	0	1	0	106	3	0	0
走行装置	1	2	4	0	0	0	7	3	1	0	1	0	0	108	0	0
装置その他	0	0	0	1	0	0	2	0	2	0	2	0	0	0	5	0
非装置	4	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0

==== Confusion matrix 2 (early_stopped-uar) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	0.91	0.00	0.02	0.00	0.00	0.00	0.01	0.01	0.01	0.02	0.01	0.00	0.00	0.00	0.00	0.00
制動装置	0.02	0.93	0.01	0.00	0.00	0.01	0.01	0.01	0.00	0.00	0.01	0.00	0.00	0.01	0.00	0.00
動力伝達	0.06	0.00	0.91	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.00	0.00	0.00	0.00	0.00
排ｶﾞｽ･騒音	0.10	0.00	0.01	0.85	0.00	0.00	0.01	0.00	0.00	0.02	0.00	0.00	0.00	0.01	0.00	0.00
乗車装置	0.01	0.00	0.00	0.00	0.95	0.00	0.02	0.00	0.00	0.00	0.01	0.00	0.00	0.00	0.00	0.00
保安灯火	0.01	0.00	0.00	0.00	0.00	0.95	0.01	0.00	0.02	0.00	0.01	0.00	0.00	0.00	0.00	0.00
車枠・車体	0.08	0.01	0.03	0.00	0.04	0.04	0.73	0.01	0.01	0.01	0.02	0.00	0.02	0.00	0.00	0.00
かじ取り	0.04	0.01	0.01	0.00	0.00	0.01	0.01	0.87	0.01	0.00	0.00	0.00	0.02	0.01	0.00	0.00
電気装置	0.08	0.02	0.00	0.00	0.04	0.06	0.04	0.02	0.69	0.01	0.03	0.01	0.00	0.00	0.00	0.00
燃料装置	0.11	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.88	0.00	0.00	0.00	0.00	0.00	0.00
その他	0.08	0.03	0.02	0.00	0.03	0.02	0.08	0.00	0.00	0.01	0.71	0.00	0.00	0.00	0.00	0.00
電動機(モーター)	0.21	0.03	0.12	0.00	0.00	0.00	0.00	0.03	0.03	0.00	0.09	0.50	0.00	0.00	0.00	0.00
緩衝装置	0.01	0.01	0.04	0.00	0.00	0.00	0.06	0.03	0.00	0.00	0.01	0.00	0.82	0.02	0.00	0.00
走行装置	0.01	0.02	0.03	0.00	0.00	0.00	0.06	0.02	0.01	0.00	0.01	0.00	0.00	0.85	0.00	0.00
装置その他	0.00	0.00	0.00	0.08	0.00	0.00	0.17	0.00	0.17	0.00	0.17	0.00	0.00	0.00	0.42	0.00
非装置	1.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00

UAR = 0.747990

==== Classification report (early_stopped-uar) ====

              precision    recall  f1-score   support

        かじ取り       0.89      0.87      0.88       299
         その他       0.81      0.71      0.76       300
        エンジン       0.88      0.91      0.89      1494
        乗車装置       0.90      0.95      0.92       290
        保安灯火       0.90      0.95      0.92       363
        制動装置       0.93      0.93      0.93       477
        動力伝達       0.91      0.91      0.91       814
     排ｶﾞｽ･騒音       0.93      0.85      0.89       122
        燃料装置       0.86      0.88      0.87       232
        緩衝装置       0.86      0.82      0.84       129
       装置その他       0.56      0.42      0.48        12
        走行装置       0.88      0.85      0.86       127
       車枠・車体       0.73      0.73      0.73       323
   電動機(モーター)       0.81      0.50      0.62        34
        電気装置       0.79      0.69      0.73       177
         非装置       0.00      0.00      0.00         4

    accuracy                           0.87      5197
   macro avg       0.79      0.75      0.76      5197
weighted avg       0.87      0.87      0.87      5197


==== Confusion matrix 1 (final model) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	1378	3	25	5	1	1	9	10	14	24	21	3	0	0	0	0
制動装置	9	448	1	0	0	1	3	4	2	0	6	1	1	1	0	0
動力伝達	67	3	719	0	2	1	5	3	2	1	4	1	2	3	1	0
排ｶﾞｽ･騒音	13	0	1	105	0	0	0	0	0	2	0	0	0	1	0	0
乗車装置	2	0	0	0	266	1	14	0	1	0	5	0	1	0	0	0
保安灯火	2	1	1	0	1	347	3	0	4	0	3	0	0	0	1	0
車枠・車体	25	4	8	2	12	11	220	5	5	3	19	0	7	1	1	0
かじ取り	11	2	2	1	0	3	7	263	2	0	1	0	6	1	0	0
電気装置	22	5	0	0	6	9	5	2	121	1	5	1	0	0	0	0
燃料装置	20	1	0	0	0	0	1	0	1	207	1	0	0	1	0	0
その他	31	9	4	1	9	7	21	1	6	3	204	0	1	1	2	0
電動機(モーター)	7	1	3	0	0	0	0	2	2	0	3	16	0	0	0	0
緩衝装置	2	1	1	0	1	0	10	4	0	0	1	0	107	2	0	0
走行装置	1	2	4	0	0	0	6	3	1	0	2	0	1	106	1	0
装置その他	0	0	0	1	0	0	3	0	1	0	2	0	0	0	5	0
非装置	4	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0

==== Confusion matrix 2 (final model) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	0.92	0.00	0.02	0.00	0.00	0.00	0.01	0.01	0.01	0.02	0.01	0.00	0.00	0.00	0.00	0.00
制動装置	0.02	0.94	0.00	0.00	0.00	0.00	0.01	0.01	0.00	0.00	0.01	0.00	0.00	0.00	0.00	0.00
動力伝達	0.08	0.00	0.88	0.00	0.00	0.00	0.01	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
排ｶﾞｽ･騒音	0.11	0.00	0.01	0.86	0.00	0.00	0.00	0.00	0.00	0.02	0.00	0.00	0.00	0.01	0.00	0.00
乗車装置	0.01	0.00	0.00	0.00	0.92	0.00	0.05	0.00	0.00	0.00	0.02	0.00	0.00	0.00	0.00	0.00
保安灯火	0.01	0.00	0.00	0.00	0.00	0.96	0.01	0.00	0.01	0.00	0.01	0.00	0.00	0.00	0.00	0.00
車枠・車体	0.08	0.01	0.02	0.01	0.04	0.03	0.68	0.02	0.02	0.01	0.06	0.00	0.02	0.00	0.00	0.00
かじ取り	0.04	0.01	0.01	0.00	0.00	0.01	0.02	0.88	0.01	0.00	0.00	0.00	0.02	0.00	0.00	0.00
電気装置	0.12	0.03	0.00	0.00	0.03	0.05	0.03	0.01	0.68	0.01	0.03	0.01	0.00	0.00	0.00	0.00
燃料装置	0.09	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.89	0.00	0.00	0.00	0.00	0.00	0.00
その他	0.10	0.03	0.01	0.00	0.03	0.02	0.07	0.00	0.02	0.01	0.68	0.00	0.00	0.00	0.01	0.00
電動機(モーター)	0.21	0.03	0.09	0.00	0.00	0.00	0.00	0.06	0.06	0.00	0.09	0.47	0.00	0.00	0.00	0.00
緩衝装置	0.02	0.01	0.01	0.00	0.01	0.00	0.08	0.03	0.00	0.00	0.01	0.00	0.83	0.02	0.00	0.00
走行装置	0.01	0.02	0.03	0.00	0.00	0.00	0.05	0.02	0.01	0.00	0.02	0.00	0.01	0.83	0.01	0.00
装置その他	0.00	0.00	0.00	0.08	0.00	0.00	0.25	0.00	0.08	0.00	0.17	0.00	0.00	0.00	0.42	0.00
非装置	1.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00

UAR = 0.740413

==== Classification report (final model) ====

              precision    recall  f1-score   support

        かじ取り       0.89      0.88      0.88       299
         その他       0.74      0.68      0.71       300
        エンジン       0.86      0.92      0.89      1494
        乗車装置       0.89      0.92      0.90       290
        保安灯火       0.91      0.96      0.93       363
        制動装置       0.93      0.94      0.94       477
        動力伝達       0.93      0.88      0.91       814
     排ｶﾞｽ･騒音       0.91      0.86      0.89       122
        燃料装置       0.86      0.89      0.88       232
        緩衝装置       0.85      0.83      0.84       129
       装置その他       0.45      0.42      0.43        12
        走行装置       0.91      0.83      0.87       127
       車枠・車体       0.72      0.68      0.70       323
   電動機(モーター)       0.73      0.47      0.57        34
        電気装置       0.75      0.68      0.71       177
         非装置       0.00      0.00      0.00         4

    accuracy                           0.87      5197
   macro avg       0.77      0.74      0.75      5197
weighted avg       0.87      0.87      0.87      5197

2020-08-20 03:12:21,124 - <module> - INFO - time spent: 4271.888973
