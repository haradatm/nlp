{
  "gpu": 0,
  "batchsize": 16,
  "learnrate": 5e-05,
  "weightdecay": 0.01,
  "epoch": 20,
  "train": "../datasets/mlit/04-train.txt",
  "eval": "../datasets/mlit/04-test.txt",
  "init_checkpoint": "../../BERT/Japanese_L-12_H-768_A-12_E-30_BPE/arrays_bert_model.ckpt.npz",
  "bert_config_file": "../../BERT/Japanese_L-12_H-768_A-12_E-30_BPE/bert_config.json",
  "vocab_file": "../../BERT/Japanese_L-12_H-768_A-12_E-30_BPE/vocab.txt",
  "out": "results_bert-2-mlit",
  "resume": "",
  "start_epoch": 1,
  "noplot": false
}
WARNING: Logging before flag parsing goes to stderr.
W0818 00:18:31.561131 140600203749248 deprecation_wrapper.py:119] From /content/drive/My Drive/Colab Notebooks/kenkyu/190816/bertlib/tokenization.py:74: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

2019-08-18 00:18:46,559 - load_data - INFO - Loading dataset ... done.
I0818 00:18:46.559090 140600203749248 <ipython-input-10-d38ff86dbbeb>:79] Loading dataset ... done.
2019-08-18 00:18:48,403 - load_data - INFO - Loading dataset ... done.
I0818 00:18:48.403457 140600203749248 <ipython-input-10-d38ff86dbbeb>:79] Loading dataset ... done.
# train: 46742, eval: 5197,
# class: 16, labels: {'エンジン': 0, '制動装置': 1, '動力伝達': 2, '排ｶﾞｽ･騒音': 3, '乗車装置': 4, '保安灯火': 5, '車枠・車体': 6, 'かじ取り': 7, '電気装置': 8, '燃料装置': 9, 'その他': 10, '電動機(モーター)': 11, '緩衝装置': 12, '走行装置': 13, '装置その他': 14, '非装置': 15}
# vocab: 32005
2019-08-18 00:51:24,479 - main - INFO - [  1] T/loss=0.656468 T/acc1=0.812866 T/acc2=0.000000 T/sec= 1819.035205 D/loss=0.494502 D/acc1=0.859342 D/acc2=0.709411 D/sec= 99.328302 lr=0.972755 eta=0.000050
I0818 00:51:24.479979 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  1] T/loss=0.656468 T/acc1=0.812866 T/acc2=0.000000 T/sec= 1819.035205 D/loss=0.494502 D/acc1=0.859342 D/acc2=0.709411 D/sec= 99.328302 lr=0.972755 eta=0.000050
saving early-stopped model (loss) at epoch 1
saving early-stopped model (uar) at epoch 1
2019-08-18 01:25:51,698 - main - INFO - [  2] T/loss=0.454335 T/acc1=0.868662 T/acc2=0.000000 T/sec= 1967.863285 D/loss=0.511545 D/acc1=0.857995 D/acc2=0.715947 D/sec= 99.355580 lr=0.998555 eta=0.000048
I0818 01:25:51.698965 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  2] T/loss=0.454335 T/acc1=0.868662 T/acc2=0.000000 T/sec= 1967.863285 D/loss=0.511545 D/acc1=0.857995 D/acc2=0.715947 D/sec= 99.355580 lr=0.998555 eta=0.000048
saving early-stopped model (uar) at epoch 2
2019-08-18 01:59:26,481 - main - INFO - [  3] T/loss=0.367100 T/acc1=0.894399 T/acc2=0.000000 T/sec= 1915.353535 D/loss=0.483086 D/acc1=0.866846 D/acc2=0.777255 D/sec= 99.428910 lr=0.999922 eta=0.000045
I0818 01:59:26.481305 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  3] T/loss=0.367100 T/acc1=0.894399 T/acc2=0.000000 T/sec= 1915.353535 D/loss=0.483086 D/acc1=0.866846 D/acc2=0.777255 D/sec= 99.428910 lr=0.999922 eta=0.000045
saving early-stopped model (loss) at epoch 3
saving early-stopped model (uar) at epoch 3
2019-08-18 02:33:28,084 - main - INFO - [  4] T/loss=0.294807 T/acc1=0.916071 T/acc2=0.000000 T/sec= 1942.214657 D/loss=0.574814 D/acc1=0.857225 D/acc2=0.729936 D/sec= 99.388469 lr=0.999996 eta=0.000043
I0818 02:33:28.084666 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  4] T/loss=0.294807 T/acc1=0.916071 T/acc2=0.000000 T/sec= 1942.214657 D/loss=0.574814 D/acc1=0.857225 D/acc2=0.729936 D/sec= 99.388469 lr=0.999996 eta=0.000043
2019-08-18 03:06:30,138 - main - INFO - [  5] T/loss=0.238080 T/acc1=0.936524 T/acc2=0.000000 T/sec= 1882.547947 D/loss=0.700995 D/acc1=0.856840 D/acc2=0.753180 D/sec= 99.505994 lr=1.000000 eta=0.000040
I0818 03:06:30.138373 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  5] T/loss=0.238080 T/acc1=0.936524 T/acc2=0.000000 T/sec= 1882.547947 D/loss=0.700995 D/acc1=0.856840 D/acc2=0.753180 D/sec= 99.505994 lr=1.000000 eta=0.000040
2019-08-18 03:39:36,085 - main - INFO - [  6] T/loss=0.198579 T/acc1=0.949446 T/acc2=0.000000 T/sec= 1886.360272 D/loss=0.822424 D/acc1=0.855109 D/acc2=0.744920 D/sec= 99.586693 lr=1.000000 eta=0.000038
I0818 03:39:36.085589 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  6] T/loss=0.198579 T/acc1=0.949446 T/acc2=0.000000 T/sec= 1886.360272 D/loss=0.822424 D/acc1=0.855109 D/acc2=0.744920 D/sec= 99.586693 lr=1.000000 eta=0.000038
2019-08-18 04:12:47,407 - main - INFO - [  7] T/loss=0.165413 T/acc1=0.960763 T/acc2=0.000000 T/sec= 1891.803348 D/loss=0.853622 D/acc1=0.853762 D/acc2=0.725662 D/sec= 99.519125 lr=1.000000 eta=0.000035
I0818 04:12:47.407809 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  7] T/loss=0.165413 T/acc1=0.960763 T/acc2=0.000000 T/sec= 1891.803348 D/loss=0.853622 D/acc1=0.853762 D/acc2=0.725662 D/sec= 99.519125 lr=1.000000 eta=0.000035
2019-08-18 04:45:55,833 - main - INFO - [  8] T/loss=0.132818 T/acc1=0.969364 T/acc2=0.000000 T/sec= 1888.908791 D/loss=0.914937 D/acc1=0.857995 D/acc2=0.752745 D/sec= 99.516674 lr=1.000000 eta=0.000033
I0818 04:45:55.833404 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  8] T/loss=0.132818 T/acc1=0.969364 T/acc2=0.000000 T/sec= 1888.908791 D/loss=0.914937 D/acc1=0.857995 D/acc2=0.752745 D/sec= 99.516674 lr=1.000000 eta=0.000033
2019-08-18 05:19:02,895 - main - INFO - [  9] T/loss=0.110827 T/acc1=0.975953 T/acc2=0.000000 T/sec= 1887.552357 D/loss=0.975036 D/acc1=0.855878 D/acc2=0.750190 D/sec= 99.510070 lr=1.000000 eta=0.000030
I0818 05:19:02.895815 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [  9] T/loss=0.110827 T/acc1=0.975953 T/acc2=0.000000 T/sec= 1887.552357 D/loss=0.975036 D/acc1=0.855878 D/acc2=0.750190 D/sec= 99.510070 lr=1.000000 eta=0.000030
2019-08-18 05:52:12,804 - main - INFO - [ 10] T/loss=0.086532 T/acc1=0.981558 T/acc2=0.000000 T/sec= 1890.415507 D/loss=1.029085 D/acc1=0.854916 D/acc2=0.723100 D/sec= 99.492936 lr=1.000000 eta=0.000028
I0818 05:52:12.804178 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 10] T/loss=0.086532 T/acc1=0.981558 T/acc2=0.000000 T/sec= 1890.415507 D/loss=1.029085 D/acc1=0.854916 D/acc2=0.723100 D/sec= 99.492936 lr=1.000000 eta=0.000028
2019-08-18 06:25:22,535 - main - INFO - [ 11] T/loss=0.068315 T/acc1=0.985880 T/acc2=0.000000 T/sec= 1890.102576 D/loss=1.167560 D/acc1=0.854531 D/acc2=0.738144 D/sec= 99.628137 lr=1.000000 eta=0.000025
I0818 06:25:22.535017 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 11] T/loss=0.068315 T/acc1=0.985880 T/acc2=0.000000 T/sec= 1890.102576 D/loss=1.167560 D/acc1=0.854531 D/acc2=0.738144 D/sec= 99.628137 lr=1.000000 eta=0.000025
2019-08-18 06:58:32,921 - main - INFO - [ 12] T/loss=0.055828 T/acc1=0.988790 T/acc2=0.000000 T/sec= 1890.826594 D/loss=1.130432 D/acc1=0.858572 D/acc2=0.747493 D/sec= 99.559841 lr=1.000000 eta=0.000023
I0818 06:58:32.921296 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 12] T/loss=0.055828 T/acc1=0.988790 T/acc2=0.000000 T/sec= 1890.826594 D/loss=1.130432 D/acc1=0.858572 D/acc2=0.747493 D/sec= 99.559841 lr=1.000000 eta=0.000023
2019-08-18 07:31:50,912 - main - INFO - [ 13] T/loss=0.044020 T/acc1=0.990715 T/acc2=0.000000 T/sec= 1898.361981 D/loss=1.236874 D/acc1=0.857610 D/acc2=0.738100 D/sec= 99.629382 lr=1.000000 eta=0.000020
I0818 07:31:50.912770 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 13] T/loss=0.044020 T/acc1=0.990715 T/acc2=0.000000 T/sec= 1898.361981 D/loss=1.236874 D/acc1=0.857610 D/acc2=0.738100 D/sec= 99.629382 lr=1.000000 eta=0.000020
2019-08-18 08:05:10,554 - main - INFO - [ 14] T/loss=0.033385 T/acc1=0.993133 T/acc2=0.000000 T/sec= 1899.846371 D/loss=1.240359 D/acc1=0.862613 D/acc2=0.753806 D/sec= 99.795017 lr=1.000000 eta=0.000018
I0818 08:05:10.554055 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 14] T/loss=0.033385 T/acc1=0.993133 T/acc2=0.000000 T/sec= 1899.846371 D/loss=1.240359 D/acc1=0.862613 D/acc2=0.753806 D/sec= 99.795017 lr=1.000000 eta=0.000018
2019-08-18 08:38:36,468 - main - INFO - [ 15] T/loss=0.026187 T/acc1=0.994202 T/acc2=0.000000 T/sec= 1906.143662 D/loss=1.329414 D/acc1=0.858957 D/acc2=0.741165 D/sec= 99.769718 lr=1.000000 eta=0.000015
I0818 08:38:36.468254 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 15] T/loss=0.026187 T/acc1=0.994202 T/acc2=0.000000 T/sec= 1906.143662 D/loss=1.329414 D/acc1=0.858957 D/acc2=0.741165 D/sec= 99.769718 lr=1.000000 eta=0.000015
2019-08-18 09:11:58,290 - main - INFO - [ 16] T/loss=0.021168 T/acc1=0.995293 T/acc2=0.000000 T/sec= 1901.955689 D/loss=1.321170 D/acc1=0.860304 D/acc2=0.729761 D/sec= 99.867554 lr=1.000000 eta=0.000013
I0818 09:11:58.290680 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 16] T/loss=0.021168 T/acc1=0.995293 T/acc2=0.000000 T/sec= 1901.955689 D/loss=1.321170 D/acc1=0.860304 D/acc2=0.729761 D/sec= 99.867554 lr=1.000000 eta=0.000013
2019-08-18 09:45:24,002 - main - INFO - [ 17] T/loss=0.017016 T/acc1=0.996427 T/acc2=0.000000 T/sec= 1905.867890 D/loss=1.331374 D/acc1=0.862805 D/acc2=0.747572 D/sec= 99.843290 lr=1.000000 eta=0.000010
I0818 09:45:24.002044 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 17] T/loss=0.017016 T/acc1=0.996427 T/acc2=0.000000 T/sec= 1905.867890 D/loss=1.331374 D/acc1=0.862805 D/acc2=0.747572 D/sec= 99.843290 lr=1.000000 eta=0.000010
2019-08-18 10:18:50,306 - main - INFO - [ 18] T/loss=0.012899 T/acc1=0.997176 T/acc2=0.000000 T/sec= 1906.494327 D/loss=1.392602 D/acc1=0.862613 D/acc2=0.758044 D/sec= 99.810189 lr=1.000000 eta=0.000008
I0818 10:18:50.306541 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 18] T/loss=0.012899 T/acc1=0.997176 T/acc2=0.000000 T/sec= 1906.494327 D/loss=1.392602 D/acc1=0.862613 D/acc2=0.758044 D/sec= 99.810189 lr=1.000000 eta=0.000008
2019-08-18 10:52:12,507 - main - INFO - [ 19] T/loss=0.010815 T/acc1=0.997390 T/acc2=0.000000 T/sec= 1902.448198 D/loss=1.353135 D/acc1=0.864537 D/acc2=0.738434 D/sec= 99.753066 lr=1.000000 eta=0.000005
I0818 10:52:12.507671 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 19] T/loss=0.010815 T/acc1=0.997390 T/acc2=0.000000 T/sec= 1902.448198 D/loss=1.353135 D/acc1=0.864537 D/acc2=0.738434 D/sec= 99.753066 lr=1.000000 eta=0.000005
2019-08-18 11:25:40,079 - main - INFO - [ 20] T/loss=0.007478 T/acc1=0.997839 T/acc2=0.000000 T/sec= 1907.703713 D/loss=1.372899 D/acc1=0.865114 D/acc2=0.746334 D/sec= 99.867510 lr=1.000000 eta=0.000003
I0818 11:25:40.079032 140600203749248 <ipython-input-10-d38ff86dbbeb>:373] [ 20] T/loss=0.007478 T/acc1=0.997839 T/acc2=0.000000 T/sec= 1907.703713 D/loss=1.372899 D/acc1=0.865114 D/acc2=0.746334 D/sec= 99.867510 lr=1.000000 eta=0.000003

==== Confusion matrix 1 (early_stopped-loss) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	1352	1	40	14	4	2	7	7	24	22	10	11	0	0	0	0
制動装置	14	443	3	1	1	2	2	1	3	0	2	3	1	1	0	0
動力伝達	57	4	723	0	1	2	9	5	1	1	1	7	0	1	2	0
排ｶﾞｽ･騒音	7	0	2	113	0	0	0	0	0	0	0	0	0	0	0	0
乗車装置	2	0	0	0	276	1	9	0	1	0	1	0	0	0	0	0
保安灯火	2	0	1	0	1	343	5	0	6	1	4	0	0	0	0	0
車枠・車体	24	3	9	7	14	13	219	6	4	5	7	1	8	1	2	0
かじ取り	14	5	0	0	1	3	6	261	3	0	0	0	3	3	0	0
電気装置	12	5	0	0	4	12	3	4	129	1	4	3	0	0	0	0
燃料装置	26	0	1	1	0	0	2	0	0	201	0	1	0	0	0	0
その他	23	6	5	2	10	7	23	1	8	4	205	3	1	1	1	0
電動機(モーター)	5	0	1	0	0	0	0	0	0	0	1	27	0	0	0	0
緩衝装置	2	0	3	1	1	0	6	5	0	0	0	1	107	3	0	0
走行装置	2	3	4	0	0	1	8	5	1	0	3	0	1	98	1	0
装置その他	0	0	0	2	0	0	0	1	0	0	1	0	0	0	8	0
非装置	2	0	0	1	0	0	0	0	0	1	0	0	0	0	0	0

==== Confusion matrix 2 (early_stopped-loss) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	0.90	0.00	0.03	0.01	0.00	0.00	0.00	0.00	0.02	0.01	0.01	0.01	0.00	0.00	0.00	0.00
制動装置	0.03	0.93	0.01	0.00	0.00	0.00	0.00	0.00	0.01	0.00	0.00	0.01	0.00	0.00	0.00	0.00
動力伝達	0.07	0.00	0.89	0.00	0.00	0.00	0.01	0.01	0.00	0.00	0.00	0.01	0.00	0.00	0.00	0.00
排ｶﾞｽ･騒音	0.06	0.00	0.02	0.93	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
乗車装置	0.01	0.00	0.00	0.00	0.95	0.00	0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
保安灯火	0.01	0.00	0.00	0.00	0.00	0.94	0.01	0.00	0.02	0.00	0.01	0.00	0.00	0.00	0.00	0.00
車枠・車体	0.07	0.01	0.03	0.02	0.04	0.04	0.68	0.02	0.01	0.02	0.02	0.00	0.02	0.00	0.01	0.00
かじ取り	0.05	0.02	0.00	0.00	0.00	0.01	0.02	0.87	0.01	0.00	0.00	0.00	0.01	0.01	0.00	0.00
電気装置	0.07	0.03	0.00	0.00	0.02	0.07	0.02	0.02	0.73	0.01	0.02	0.02	0.00	0.00	0.00	0.00
燃料装置	0.11	0.00	0.00	0.00	0.00	0.00	0.01	0.00	0.00	0.87	0.00	0.00	0.00	0.00	0.00	0.00
その他	0.08	0.02	0.02	0.01	0.03	0.02	0.08	0.00	0.03	0.01	0.68	0.01	0.00	0.00	0.00	0.00
電動機(モーター)	0.15	0.00	0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.03	0.79	0.00	0.00	0.00	0.00
緩衝装置	0.02	0.00	0.02	0.01	0.01	0.00	0.05	0.04	0.00	0.00	0.00	0.01	0.83	0.02	0.00	0.00
走行装置	0.02	0.02	0.03	0.00	0.00	0.01	0.06	0.04	0.01	0.00	0.02	0.00	0.01	0.77	0.01	0.00
装置その他	0.00	0.00	0.00	0.17	0.00	0.00	0.00	0.08	0.00	0.00	0.08	0.00	0.00	0.00	0.67	0.00
非装置	0.50	0.00	0.00	0.25	0.00	0.00	0.00	0.00	0.00	0.25	0.00	0.00	0.00	0.00	0.00	0.00

UAR = 0.777255

==== Classification report (early_stopped-loss) ====

              precision    recall  f1-score   support

        かじ取り       0.88      0.87      0.88       299
         その他       0.86      0.68      0.76       300
        エンジン       0.88      0.90      0.89      1494
        乗車装置       0.88      0.95      0.92       290
        保安灯火       0.89      0.94      0.92       363
        制動装置       0.94      0.93      0.94       477
        動力伝達       0.91      0.89      0.90       814
     排ｶﾞｽ･騒音       0.80      0.93      0.86       122
        燃料装置       0.85      0.87      0.86       232
        緩衝装置       0.88      0.83      0.86       129
       装置その他       0.57      0.67      0.62        12
        走行装置       0.91      0.77      0.83       127
       車枠・車体       0.73      0.68      0.70       323
   電動機(モーター)       0.47      0.79      0.59        34
        電気装置       0.72      0.73      0.72       177
         非装置       0.00      0.00      0.00         4

    accuracy                           0.87      5197
   macro avg       0.76      0.78      0.76      5197
weighted avg       0.87      0.87      0.87      5197

/usr/local/lib/python3.6/dist-packages/sklearn/metrics/classification.py:1437: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)

==== Confusion matrix 1 (early_stopped-uar) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	1352	1	40	14	4	2	7	7	24	22	10	11	0	0	0	0
制動装置	14	443	3	1	1	2	2	1	3	0	2	3	1	1	0	0
動力伝達	57	4	723	0	1	2	9	5	1	1	1	7	0	1	2	0
排ｶﾞｽ･騒音	7	0	2	113	0	0	0	0	0	0	0	0	0	0	0	0
乗車装置	2	0	0	0	276	1	9	0	1	0	1	0	0	0	0	0
保安灯火	2	0	1	0	1	343	5	0	6	1	4	0	0	0	0	0
車枠・車体	24	3	9	7	14	13	219	6	4	5	7	1	8	1	2	0
かじ取り	14	5	0	0	1	3	6	261	3	0	0	0	3	3	0	0
電気装置	12	5	0	0	4	12	3	4	129	1	4	3	0	0	0	0
燃料装置	26	0	1	1	0	0	2	0	0	201	0	1	0	0	0	0
その他	23	6	5	2	10	7	23	1	8	4	205	3	1	1	1	0
電動機(モーター)	5	0	1	0	0	0	0	0	0	0	1	27	0	0	0	0
緩衝装置	2	0	3	1	1	0	6	5	0	0	0	1	107	3	0	0
走行装置	2	3	4	0	0	1	8	5	1	0	3	0	1	98	1	0
装置その他	0	0	0	2	0	0	0	1	0	0	1	0	0	0	8	0
非装置	2	0	0	1	0	0	0	0	0	1	0	0	0	0	0	0

==== Confusion matrix 2 (early_stopped-uar) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	0.90	0.00	0.03	0.01	0.00	0.00	0.00	0.00	0.02	0.01	0.01	0.01	0.00	0.00	0.00	0.00
制動装置	0.03	0.93	0.01	0.00	0.00	0.00	0.00	0.00	0.01	0.00	0.00	0.01	0.00	0.00	0.00	0.00
動力伝達	0.07	0.00	0.89	0.00	0.00	0.00	0.01	0.01	0.00	0.00	0.00	0.01	0.00	0.00	0.00	0.00
排ｶﾞｽ･騒音	0.06	0.00	0.02	0.93	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
乗車装置	0.01	0.00	0.00	0.00	0.95	0.00	0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00
保安灯火	0.01	0.00	0.00	0.00	0.00	0.94	0.01	0.00	0.02	0.00	0.01	0.00	0.00	0.00	0.00	0.00
車枠・車体	0.07	0.01	0.03	0.02	0.04	0.04	0.68	0.02	0.01	0.02	0.02	0.00	0.02	0.00	0.01	0.00
かじ取り	0.05	0.02	0.00	0.00	0.00	0.01	0.02	0.87	0.01	0.00	0.00	0.00	0.01	0.01	0.00	0.00
電気装置	0.07	0.03	0.00	0.00	0.02	0.07	0.02	0.02	0.73	0.01	0.02	0.02	0.00	0.00	0.00	0.00
燃料装置	0.11	0.00	0.00	0.00	0.00	0.00	0.01	0.00	0.00	0.87	0.00	0.00	0.00	0.00	0.00	0.00
その他	0.08	0.02	0.02	0.01	0.03	0.02	0.08	0.00	0.03	0.01	0.68	0.01	0.00	0.00	0.00	0.00
電動機(モーター)	0.15	0.00	0.03	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.03	0.79	0.00	0.00	0.00	0.00
緩衝装置	0.02	0.00	0.02	0.01	0.01	0.00	0.05	0.04	0.00	0.00	0.00	0.01	0.83	0.02	0.00	0.00
走行装置	0.02	0.02	0.03	0.00	0.00	0.01	0.06	0.04	0.01	0.00	0.02	0.00	0.01	0.77	0.01	0.00
装置その他	0.00	0.00	0.00	0.17	0.00	0.00	0.00	0.08	0.00	0.00	0.08	0.00	0.00	0.00	0.67	0.00
非装置	0.50	0.00	0.00	0.25	0.00	0.00	0.00	0.00	0.00	0.25	0.00	0.00	0.00	0.00	0.00	0.00

UAR = 0.777255

==== Classification report (early_stopped-uar) ====

              precision    recall  f1-score   support

        かじ取り       0.88      0.87      0.88       299
         その他       0.86      0.68      0.76       300
        エンジン       0.88      0.90      0.89      1494
        乗車装置       0.88      0.95      0.92       290
        保安灯火       0.89      0.94      0.92       363
        制動装置       0.94      0.93      0.94       477
        動力伝達       0.91      0.89      0.90       814
     排ｶﾞｽ･騒音       0.80      0.93      0.86       122
        燃料装置       0.85      0.87      0.86       232
        緩衝装置       0.88      0.83      0.86       129
       装置その他       0.57      0.67      0.62        12
        走行装置       0.91      0.77      0.83       127
       車枠・車体       0.73      0.68      0.70       323
   電動機(モーター)       0.47      0.79      0.59        34
        電気装置       0.72      0.73      0.72       177
         非装置       0.00      0.00      0.00         4

    accuracy                           0.87      5197
   macro avg       0.76      0.78      0.76      5197
weighted avg       0.87      0.87      0.87      5197


==== Confusion matrix 1 (final model) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	1357	5	44	5	5	2	8	10	17	24	12	3	0	2	0	0
制動装置	10	443	4	0	3	3	1	1	2	0	5	0	2	3	0	0
動力伝達	50	5	735	0	0	1	8	3	2	1	3	1	0	5	0	0
排ｶﾞｽ･騒音	14	0	1	103	0	0	1	0	1	2	0	0	0	0	0	0
乗車装置	2	0	1	0	271	2	8	0	2	0	3	0	0	0	0	1
保安灯火	3	0	1	0	1	344	6	1	3	0	4	0	0	0	0	0
車枠・車体	24	3	11	4	13	11	222	4	2	4	12	0	10	2	1	0
かじ取り	11	6	1	0	1	2	5	264	2	0	0	0	4	3	0	0
電気装置	20	5	2	0	6	12	5	3	116	1	6	0	1	0	0	0
燃料装置	25	0	0	0	0	1	5	0	0	199	1	0	0	1	0	0
その他	33	9	9	1	7	5	24	1	7	3	197	0	2	1	1	0
電動機(モーター)	3	1	2	0	0	0	0	0	2	0	2	24	0	0	0	0
緩衝装置	4	0	2	0	0	0	5	7	0	0	0	0	106	4	1	0
走行装置	2	3	3	0	0	0	3	5	0	0	0	0	0	111	0	0
装置その他	0	0	0	0	0	0	1	0	1	0	5	0	0	1	4	0
非装置	2	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0

==== Confusion matrix 2 (final model) ====

	エンジン	制動装置	動力伝達	排ｶﾞｽ･騒音	乗車装置	保安灯火	車枠・車体	かじ取り	電気装置	燃料装置	その他	電動機(モーター)	緩衝装置	走行装置	装置その他	非装置
エンジン	0.91	0.00	0.03	0.00	0.00	0.00	0.01	0.01	0.01	0.02	0.01	0.00	0.00	0.00	0.00	0.00
制動装置	0.02	0.93	0.01	0.00	0.01	0.01	0.00	0.00	0.00	0.00	0.01	0.00	0.00	0.01	0.00	0.00
動力伝達	0.06	0.01	0.90	0.00	0.00	0.00	0.01	0.00	0.00	0.00	0.00	0.00	0.00	0.01	0.00	0.00
排ｶﾞｽ･騒音	0.11	0.00	0.01	0.84	0.00	0.00	0.01	0.00	0.01	0.02	0.00	0.00	0.00	0.00	0.00	0.00
乗車装置	0.01	0.00	0.00	0.00	0.93	0.01	0.03	0.00	0.01	0.00	0.01	0.00	0.00	0.00	0.00	0.00
保安灯火	0.01	0.00	0.00	0.00	0.00	0.95	0.02	0.00	0.01	0.00	0.01	0.00	0.00	0.00	0.00	0.00
車枠・車体	0.07	0.01	0.03	0.01	0.04	0.03	0.69	0.01	0.01	0.01	0.04	0.00	0.03	0.01	0.00	0.00
かじ取り	0.04	0.02	0.00	0.00	0.00	0.01	0.02	0.88	0.01	0.00	0.00	0.00	0.01	0.01	0.00	0.00
電気装置	0.11	0.03	0.01	0.00	0.03	0.07	0.03	0.02	0.66	0.01	0.03	0.00	0.01	0.00	0.00	0.00
燃料装置	0.11	0.00	0.00	0.00	0.00	0.00	0.02	0.00	0.00	0.86	0.00	0.00	0.00	0.00	0.00	0.00
その他	0.11	0.03	0.03	0.00	0.02	0.02	0.08	0.00	0.02	0.01	0.66	0.00	0.01	0.00	0.00	0.00
電動機(モーター)	0.09	0.03	0.06	0.00	0.00	0.00	0.00	0.00	0.06	0.00	0.06	0.71	0.00	0.00	0.00	0.00
緩衝装置	0.03	0.00	0.02	0.00	0.00	0.00	0.04	0.05	0.00	0.00	0.00	0.00	0.82	0.03	0.01	0.00
走行装置	0.02	0.02	0.02	0.00	0.00	0.00	0.02	0.04	0.00	0.00	0.00	0.00	0.00	0.87	0.00	0.00
装置その他	0.00	0.00	0.00	0.00	0.00	0.00	0.08	0.00	0.08	0.00	0.42	0.00	0.00	0.08	0.33	0.00
非装置	0.50	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.00	0.25	0.25	0.00	0.00	0.00	0.00	0.00

UAR = 0.746334

==== Classification report (final model) ====

              precision    recall  f1-score   support

        かじ取り       0.88      0.88      0.88       299
         その他       0.78      0.66      0.72       300
        エンジン       0.87      0.91      0.89      1494
        乗車装置       0.88      0.93      0.91       290
        保安灯火       0.90      0.95      0.92       363
        制動装置       0.92      0.93      0.93       477
        動力伝達       0.90      0.90      0.90       814
     排ｶﾞｽ･騒音       0.91      0.84      0.88       122
        燃料装置       0.85      0.86      0.85       232
        緩衝装置       0.85      0.82      0.83       129
       装置その他       0.57      0.33      0.42        12
        走行装置       0.83      0.87      0.85       127
       車枠・車体       0.74      0.69      0.71       323
   電動機(モーター)       0.86      0.71      0.77        34
        電気装置       0.74      0.66      0.69       177
         非装置       0.00      0.00      0.00         4

    accuracy                           0.87      5197
   macro avg       0.78      0.75      0.76      5197
weighted avg       0.86      0.87      0.86      5197

2019-08-18 11:29:44,603 - <module> - INFO - time spent: 40278.987309 sec

I0818 11:29:44.603240 140600203749248 <ipython-input-10-d38ff86dbbeb>:648] time spent: 40278.987309 sec
